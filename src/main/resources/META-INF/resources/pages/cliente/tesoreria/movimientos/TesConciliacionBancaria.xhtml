<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" template="/templates/template.xhtml">
    <ui:define name="title">Conciliacion Bancaria</ui:define>
    <ui:define name="content">
        <h:form id="form">
            <script>
			PrimeFaces.locales['es'] = {
				closeText : 'Cerrar',
				prevText : 'Anterior',
				nextText : 'Siguiente',
				monthNames : [ 'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo',
						'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre',
						'Noviembre', 'Diciembre' ],
				monthNamesShort : [ 'Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun',
						'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic' ],
				dayNames : [ 'Domingo', 'Lunes', 'Martes', 'Miércoles',
						'Jueves', 'Viernes', 'Sábado' ],
				dayNamesShort : [ 'Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie',
						'Sab' ],
				dayNamesMin : [ 'D', 'L', 'M', 'X', 'J', 'V', 'S' ],
				weekHeader : 'Semana',
				firstDay : 1,
				isRTL : false,
				showMonthAfterYear : false,
				yearSuffix : '',
				timeOnlyTitle : 'Sólo hora',
				timeText : 'Tiempo',
				hourText : 'Hora',
				minuteText : 'Minuto',
				secondText : 'Segundo',
				millisecondText : 'Milisegundo',
				currentText : 'Fecha actual',
				ampm : false,
				month : 'Mes',
				week : 'Semana',
				day : 'Día',
				allDayText : 'Todo el día',
				today : 'Hoy',
				clear : 'Claro'
			};






        
            


            </script>
            <div class="grid crud-demo">
                <div class="col-12">
                    <p:growl id="messages" showDetail="true" autoUpdate="true" closable="true"/>
                    <div class="card ui-fluid">
                        <h5>Conciliacion Bancaria</h5>
                        <div class="field grid">
                            <p:outputLabel for="bancoLb"
                                           styleClass="col-12 mb-2 md:col-2 mb-md-0">Banco
                            </p:outputLabel>
                            <div class="col-12 md:col-2">
                                <p:inputText id="bancoLb" placeholder="Pulse F9 para seleccionar banco"
                                             autocomplete="off"
                                             value="#{tesConciliacionValorController.bsPersonaJuridica.nombreCompleto}"
                                             required="true"
                                             requiredMessage="Debe seleccionar un banco"
                                             styleClass="ui-state-error"
                                             onkeydown="if (event.keyCode == 120) {
										PF('dlgBanco').show()
									}"/>
                                <p:message for="bancoLb"/>
                            </div>
                        </div>
                        <div class="field grid">
                            <p:outputLabel for="fecdesde"
                                           styleClass="col-12 mb-2 md:col-2 mb-md-0">Fecha Desde
                            </p:outputLabel>
                            <div class="col-12 md:col-2">
                                <p:datePicker id="fecdesde" autocomplete="off" showIcon="true"
                                              value="#{tesConciliacionValorController.fecDesde}"
                                              pattern="dd/MM/yyyy"
                                              showButtonBar="true"
                                              mask="true"
                                              showOnFocus="false">
                                </p:datePicker>
                            </div>
                        </div>
                        <div class="field grid">
                            <p:outputLabel for="fechasta"
                                           styleClass="col-12 mb-2 md:col-2 mb-md-0">Fecha Hasta
                            </p:outputLabel>
                            <div class="col-12 md:col-2">
                                <p:datePicker id="fechasta" autocomplete="off" showIcon="true"
                                              value="#{tesConciliacionValorController.fecHasta}"
                                              pattern="dd/MM/yyyy"
                                              showButtonBar="true"
                                              mask="true"
                                              showOnFocus="false">
                                </p:datePicker>
                            </div>
                        </div>
                        <div class="card">
                            <h5>Procesar</h5>
                            <div class="formgroup-inline flex justify-content-between align-items-center flex-wrap">

                                <div class="field col-4 md:col-1">
                                    <p:outputLabel for="formato" value="Estado"/>
                                </div>
                                <div class="field col-4 md:col-2 mr-7">
                                    <p:selectOneMenu id="formato"
                                                     value="#{tesConciliacionValorController.indConciliado}">
                                        <f:selectItem itemLabel="Selecciona un Estado"
                                                      itemValue="#{null}" noSelectionOption="true"/>
                                        <f:selectItem itemLabel="CONCILIADO" itemValue="S"/>
                                        <f:selectItem itemLabel="NO CONCILIADO" itemValue="N"/>
                                    </p:selectOneMenu>
                                </div>
                                <div class="field md:col-2">
                                    <p:commandButton
                                            actionListener="#{tesConciliacionValorController.consultarValoresAConciliar}"
                                            value="Consultar"
                                            process="@form"
                                            update=":form:messages :form:bancoLb"
                                            icon="pi pi-cloud-download"
                                            styleClass="ui-button-info"/>
                                </div>
                                <div class="field md:col-2">
                                    <p:commandButton value="Guardar" icon="pi pi-save"
                                                     id="btnGuardar"
                                                     disabled="#{tesConciliacionValorController.valorConciliacionDtoListSelected.size() == 0}"
                                                     actionListener="#{tesConciliacionValorController.guardar}"
                                                     update=":form" styleClass="ui-button-success"
                                                     style="margin-right: .5rem"/>
                                </div>
                                <div class="field md:col-2">
                                    <p:commandButton value="Limpiar Detalles" icon="pi pi-bolt"
                                                     id="btnLimpiar"
                                                     disabled="#{tesConciliacionValorController.valorConciliacionDtoListSelected.size() == 0}"
                                                     actionListener="#{tesConciliacionValorController.limpiarDetalle}"
                                                     process="@this"
                                                     update=":form:dt-conciliacion :form:btnGuardar"
                                                     styleClass="ui-button-primary"
                                                     style="margin-right: .5rem"/>
                                </div>
                                <div class="field md:col-2">
                                    <p:commandButton
                                            id="btnEliminar"
                                            value="Eliminar" icon="pi pi-trash"
                                            disabled="#{tesConciliacionValorController.valorConciliacionDtoListSelected.size() == 0}"
                                            actionListener="#{tesConciliacionValorController.delete}"
                                            update=":form" styleClass="ui-button-danger"
                                            style="margin-right: .5rem"/>
                                </div>


                            </div>

                        </div>
                    </div>

                    <p:panel id="manage-conciliacion">
                        <p:dataTable id="dt-conciliacion" widgetVar="dtConciliacion" var="valor"
                                     rendered="#{tesConciliacionValorController.esVisibleFormulario}"
                                     value="#{tesConciliacionValorController.valorConciliacionDtoList}"
                                     selection="#{tesConciliacionValorController.valorConciliacionDtoListSelected}"
                                     paginator="true" rows="10" paginatorPosition="bottom"
                                     rowKey="#{valor.id}" selectionPageOnly="false"
                                     emptyMessage="No hay Registros">
                            <f:facet name="header">
                                <div class="products-table-header">
										<span class="filter-container ui-input-icon-left"> <i
                                                class="pi pi-search"></i> <p:inputText id="globalFilter"
                                                                                       onkeyup="PF('dtConciliacion').filter()"
                                                                                       placeholder="Buscar..."/>
										</span>
                                </div>
                            </f:facet>

                            <!--
                            <p:ajax event="rowSelect"
                            <p:ajax event="rowUnselect"
                             -->
                            <p:ajax event="rowSelectCheckbox"
                                    listener="#{tesConciliacionValorController.onRowSelect}"/>
                            <p:ajax event="rowUnselectCheckbox"
                                    listener="#{tesConciliacionValorController.onRowUnselect}"/>
                            <p:column selectionMode="multiple"
                                      style="width:16px;text-align:center"/>
                            <p:column headerText="Tipo Registro"
                                      sortBy="#{valor.tipoRegistro}"
                                      filterBy="#{valor.tipoRegistro}">
                                <h:outputText value="#{valor.tipoRegistro}"/>
                            </p:column>
                            <p:column headerText="Tipo Valor"
                                      sortBy="#{valor.tipoValor}"
                                      filterBy="#{valor.tipoValor}">
                                <h:outputText value="#{valor.tipoValor}"/>
                            </p:column>
                            <p:column headerText="Nro. Comprobante"
                                      sortBy="#{valor.nroComprobante}"
                                      filterBy="#{valor.nroComprobante}">
                                <h:outputText value="#{valor.nroComprobante}"/>
                            </p:column>
                            <p:column headerText="Tipo Comprobante"
                                      sortBy="#{valor.tipoComprobante}"
                                      filterBy="#{valor.tipoComprobante}">
                                <h:outputText value="#{valor.tipoComprobante}"/>
                            </p:column>
                            <p:column headerText="Nro. Valor" sortBy="#{valor.nroValor}">
                                <h:outputText value="#{valor.nroValor}">
                                    <f:convertNumber pattern="###,###,###"/>
                                </h:outputText>
                            </p:column>
                            <p:column>
                                <f:facet name="header">Fecha Valor</f:facet>
                                <f:facet name="footer">
                                    <h5 class="text-sm">Total Seleccionado:</h5>
                                </f:facet>
                                <h:outputText value="#{valor.fechaValor}"
                                              converter="localDateConverter">
                                </h:outputText>
                            </p:column>
                            <p:column>
                                <f:facet name="header">Fecha Vencimiento Valor</f:facet>
                                <h:outputText value="#{valor.fechaVencimiento}"
                                              converter="localDateConverter">
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Monto Valor">
                                <f:facet name="footer">
                                    <h:outputText
                                            value="#{tesConciliacionValorController.montoTotalConciliado}">
                                        <f:convertNumber pattern="###,###,###"/>
                                    </h:outputText>
                                </f:facet>
                                <h:outputText value="#{valor.montoValor}">
                                    <f:convertNumber pattern="###,###,###"/>
                                </h:outputText>
                            </p:column>

                        </p:dataTable>
                    </p:panel>

                </div>
                <p:dialog widgetVar="dlgBanco" header="Buscar Persona"
                          width="850" showEffect="fade" modal="true">
                    <p:dataTable widgetVar="dtPersona" var="persona"
                                 value="#{tesConciliacionValorController.lazyPersonaList}" id="dt-persona"
                                 paginator="true" rows="10" paginatorPosition="bottom"
                                 emptyMessage="No hay Registros">
                        <f:facet name="header">
                            <div class="products-table-header">
										<span class="filter-container ui-input-icon-left"> <i
                                                class="pi pi-search"></i> <p:inputText id="globalFilter"
                                                                                       onkeyup="PF('dtPersona').filter()"
                                                                                       placeholder="Buscar..."/>
										</span>
                            </div>
                        </f:facet>
                        <p:column style="width:3rem;text-align: center">
                            <p:commandButton oncomplete="PF('dlgBanco').hide()"
                                             process="@this"
                                             icon="pi pi-check-circle" title="Seleccionar"
                                             update=":form:bancoLb">
                                <f:setPropertyActionListener value="#{persona}"
                                                             target="#{tesConciliacionValorController.bsPersonaJuridica}"/>
                            </p:commandButton>
                        </p:column>
                        <p:column headerText="Nombre" sortBy="#{persona.nombreCompleto}"
                                  filterBy="#{persona.nombreCompleto}">
                            <h:outputText value="#{persona.nombreCompleto}"/>
                        </p:column>
                        <p:column headerText="Documento" sortBy="#{persona.documento}"
                                  filterBy="#{persona.documento}">
                            <h:outputText value="#{persona.documento}"/>
                        </p:column>
                    </p:dataTable>
                </p:dialog>
            </div>
        </h:form>
    </ui:define>

</ui:composition>